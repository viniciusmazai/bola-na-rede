<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bola na Rede: Idle Tycoon</title>
  <script src="https://cdn.jsdelivr.net/npm/break_infinity.js@2.1.0/dec.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', sans-serif; background: #228B22; color: white; text-align: center; padding: 20px; }
    h1 { font-size: 24px; margin: 10px 0; }
    .bola { width: 180px; height: 180px; margin: 30px auto; cursor: pointer; transition: transform 0.1s; }
    .bola:active { transform: scale(0.9); }
    .stats { font-size: 18px; margin: 10px 0; font-weight: bold; }
    .atleta { background: #006400; margin: 8px; padding: 12px; border-radius: 8px; text-align: left; }
    .btn { background: #FFD700; color: black; border: none; padding: 10px 16px; margin: 5px; border-radius: 6px; cursor: pointer; font-weight: bold; }
    .golden { background: gold !important; animation: pulse 1s infinite; }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } }
    .estadio { font-size: 16px; margin: 10px; }
  </style>
</head>
<body>
  <h1>Bola na Rede</h1>
  <div class="stats">Reais: <span id="redes">0</span> | GPS: <span id="gps">0</span>/s</div>
  <div class="estadio">Estádio: <span id="estadio">Campinho Furado</span></div>

  <div class="bola" id="bola">
    <svg viewBox="0 0 100 100">
      <circle cx="50" cy="50" r="45" fill="black"/>
      <path d="M30 20 Q50 10 70 20" stroke="white" stroke-width="3" fill="none"/>
      <path d="M25 35 Q50 25 75 35" stroke="white" stroke-width="3" fill="none"/>
      <path d="M30 50 Q50 40 70 50" stroke="white" stroke-width="3" fill="none"/>
      <path d="M25 65 Q50 55 75 65" stroke="white" stroke-width="3" fill="none"/>
      <path d="M30 80 Q50 70 70 80" stroke="white" stroke-width="3" fill="none"/>
    </svg>
  </div>

  <div id="goldenBtn" style="display:none">
    <button class="btn golden">GOLDEN REDE! (x7 por 77s)</button>
  </div>

  <div id="atletas"></div>

  <button class="btn" onclick="prestige()">PRESTIGE (Nível <span id="prestigeLevel">0</span>)</button>
  <button class="btn" onclick="save()">SALVAR</button>

  <script>
    // Big numbers
    let redes = new Decimal(0);
    let gps = new Decimal(0);
    let prestigeLevel = 0;
    let prestigeMult = new Decimal(1);
    let lastTime = Date.now();
    let goldenActive = false;
    let goldenEnd = 0;
    let estadioLevel = 1;

    const atletas = [
      { nome: "Garoto Laje", base: 10, prod: 0.1, owned: 0 },
      { nome: "Zagueiro Muro", base: 50, prod: 0.5, owned: 0 },
      { nome: "Driblador Poeira", base: 200, prod: 2, owned: 0 },
      { nome: "Chuta-Fome", base: 1000, prod: 8, owned: 0 },
      { nome: "Técnico Raiz", base: 5000, prod: 20, owned: 0 }
    ];

    function format(num) {
      return num.toStringWithDecimalPlaces(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    function updateGPS() {
      gps = new Decimal(0);
      atletas.forEach(a => {
        gps = gps.plus(new Decimal(a.prod).times(a.owned));
      });
      gps = gps.times(prestigeMult).times(estadioBonus());
      document.getElementById("gps").innerText = format(gps);
    }

    function estadioBonus() {
      return estadioLevel === 2 ? new Decimal(1.15) : new Decimal(1);
    }

    function buy(index) {
      const a = atletas[index];
      const cost = new Decimal(a.base).times(new Decimal(1.15).pow(a.owned));
      if (redes.gte(cost)) {
        redes = redes.minus(cost);
        a.owned++;
        updateGPS();
        renderAtletas();
      }
    }

    function renderAtletas() {
      const container = document.getElementById("atletas");
      container.innerHTML = "";
      atletas.forEach((a, i) => {
        const cost = new Decimal(a.base).times(new Decimal(1.15).pow(a.owned));
        const div = document.createElement("div");
        div.className = "atleta";
        div.innerHTML = `
          <strong>${a.nome}</strong> (x${a.owned})<br>
          Produz: ${a.prod}/s | Custo: ${format(cost)}
          <button class="btn" onclick="buy(${i})" ${redes.lt(cost) ? 'disabled' : ''}>Comprar</button>
        `;
        container.appendChild(div);
      });
    }

    function prestige() {
      if (redes.gte(1000000)) {
        prestigeLevel++;
        prestigeMult = prestigeMult.times(1.1);
        redes = new Decimal(0);
        atletas.forEach(a => a.owned = 0);
        estadioLevel = 1;
        updateGPS();
        document.getElementById("prestigeLevel").innerText = prestigeLevel;
        renderAtletas();
      }
    }

    function goldenRede() {
      if (!goldenActive && Math.random() < 0.1) {
        document.getElementById("goldenBtn").style.display = "block";
        setTimeout(() => {
          document.getElementById("goldenBtn").style.display = "none";
        }, 15000);
      }
    }

    document.getElementById("bola").onclick = () => {
      redes = redes.plus(1);
      if ('vibrate' in navigator) navigator.vibrate(50);
      updateDisplay();
    };

    document.getElementById("goldenBtn").onclick = () => {
      goldenActive = true;
      goldenEnd = Date.now() + 77000;
      document.getElementById("goldenBtn").style.display = "none";
    };

    function updateDisplay() {
      document.getElementById("redes").innerText = format(redes);
      if (redes.gte(100000) && estadioLevel === 1) {
        estadioLevel = 2;
        document.getElementById("estadio").innerText = "Várzea Lotada (+15%)";
      }
    }

    function gameLoop() {
      const now = Date.now();
      const delta = Math.min((now - lastTime) / 1000, 86400);
      const earn = gps.times(delta);
      redes = redes.plus(earn);
      if (goldenActive && now < goldenEnd) {
        redes = redes.plus(gps.times(6).times(delta));
      } else {
        goldenActive = false;
      }
      lastTime = now;
      updateDisplay();
      updateGPS();
      renderAtletas();
      goldenRede();
      save();
    }

    function save() {
      const data = { redes: redes.toString(), gps: gps.toString(), atletas, prestigeLevel, prestigeMult: prestigeMult.toString(), lastTime, estadioLevel };
      localStorage.setItem("bolaNaRedeSave", JSON.stringify(data));
    }

    function load() {
      const saved = localStorage.getItem("bolaNaRedeSave");
      if (saved) {
        const data = JSON.parse(saved);
        redes = new Decimal(data.redes);
        gps = new Decimal(data.gps);
        Object.assign(atletas, data.atletas);
        prestigeLevel = data.prestigeLevel;
        prestigeMult = new Decimal(data.prestigeMult);
        lastTime = data.lastTime;
        estadioLevel = data.estadioLevel;
        document.getElementById("prestigeLevel").innerText = prestigeLevel;
      }
    }

    // Init
    load();
    updateGPS();
    renderAtletas();
    setInterval(gameLoop, 1000);
    setInterval(save, 5000);
  </script>
</body>
</html>
